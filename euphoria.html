<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Euphoria 2k25 Registration</title>
  
  <style>

body {
  font-family: 'Courier New', Courier, monospace;
  margin: 0;
  padding: 0;
  background: #000000;
  color: #33ff33;
}

h1, h2, h3 {
  text-align: center;
  margin: 10px 0;
  color: #33ff33;
  text-shadow: 0 0 8px #00ff00;
}

h1 {
  font-size: 3em;
  text-transform: uppercase;
  letter-spacing: 2px;
}

h2, h3 {
  font-size: 1.6em;
}

label {
  font-weight: bold;
  display: block;
  margin-bottom: 5px;
  color: #ff3333;
}

input, select {
  width: calc(100% - 20px);
  padding: 10px;
  margin-bottom: 15px;
  border: 2px solid #33ff33;
  border-radius: 5px;
  box-sizing: border-box;
  font-size: 14px;
  background-color: #000000;
  color: #33ff33;
  outline: none;
  transition: border-color 0.3s ease-in-out, box-shadow 0.3s ease-in-out;
}

input:focus, select:focus {
  border-color: #ff3333;
  box-shadow: 0 0 10px #ff3333;
}

input[type="checkbox"] {
  width: auto;
  margin-right: 5px;
}

button {
  padding: 10px 15px;
  font-size: 14px;
  border: 2px solid #33ff33;
  border-radius: 5px;
  cursor: pointer;
  background-color: #000000;
  color: #33ff33;
  transition: background-color 0.3s, transform 0.2s;
}

button:hover {
  background-color: #33ff33;
  color: #000000;
  transform: scale(1.05);
}

#deleteButton, #exportButton, .exportTypeButton, #printButton {
  margin: 10px 5px;
  padding: 10px 15px;
  font-size: 14px;
  border: 2px solid #ff3333;
  background-color: #000000;
  color: #ff3333;
}

#deleteButton:hover, #exportButton:hover, .exportTypeButton:hover, #printButton:hover {
  background-color: #ff3333;
  color: #000000;
  transform: scale(1.05);
}

/* Form Styling */
form {
  max-width: 600px;
  margin: 20px auto;
  background: rgba(0, 0, 0, 0.8);
  padding: 20px;
  border-radius: 10px;
  border: 2px solid #33ff33;
  box-shadow: 0 0 20px rgba(51, 255, 51, 0.4);
}

form div {
  margin-bottom: 15px;
}

/* Table Styling */
table {
  width: 90%;
  margin: 20px auto;
  border-collapse: collapse;
  background: rgba(0, 0, 0, 0.9);
  border: 2px solid #33ff33;
  border-radius: 10px;
  overflow: hidden;
  box-shadow: 0 0 15px rgba(51, 255, 51, 0.2);
}

th, td {
  padding: 10px;
  text-align: left;
  border: 1px solid #33ff33;
  color: #33ff33;
}

th {
  background-color: #000000;
  font-weight: bold;
  text-transform: uppercase;
}

tr:nth-child(even) {
  background-color: #001a00;
}

tr:hover {
  background-color: #003300;
  color: #ff3333;
  cursor: pointer;
}

/* Responsive Design */
@media (max-width: 768px) {
  form {
    padding: 15px;
  }

  button {
    width: 100%;
    margin: 10px 0;
  }

  table {
    font-size: 14px;
  }
}

@media (max-width: 480px) {
  form {
    padding: 10px;
  }

  input, select {
    font-size: 12px;
  }

  button {
    font-size: 12px;
  }

  table {
    font-size: 12px;
  }

  th, td {
    padding: 8px;
  }
}
#resetButton {
  padding: 10px 15px;
  font-size: 14px;
  border: 2px solid #ff3333;
  border-radius: 5px;
  cursor: pointer;
  background-color: #000000;
  color: #ff3333;
  transition: background-color 0.3s, transform 0.2s;
}

#resetButton:hover {
  background-color: #ff3333;
  color: #000000;
  transform: scale(1.05);
}


</style>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.3/xlsx.full.min.js"></script>
</head>
<body>

<h1>Euphoria 2K25</h1>
<h2>Tech and Management Fest</h2>
<h3>Offline Registration Portal</h3>

<!-- Registration Form -->
<form id="registrationForm" onsubmit="handleSubmit(event)">
  <label for="eventType">Choose Event:</label>
  <select id="eventType" required onchange="displayItems()">
    <option value="">Select Event</option>
    <option value="management">Management</option>
    <option value="tech">Tech</option>
    <option value="common">Common</option>
  </select>

  <div id="eventItems" style="display:none;">
    <label for="eventItem">Select Item:</label>
    <select id="eventItem" required onchange="updateTeamInput()">
      <!-- Dynamically populated based on selected event -->
    </select>
  </div>

  <div id="teamMembers" style="display:none;">
    <h3>Team Members Details:</h3>
    <label>Team Member 1 :</label>
    <input type="text" id="teamMember1" placeholder="Team Member 1 Name" required>
    <input type="text" id="phone1" placeholder="Phone Number" required>
    <input type="text" id="college1" placeholder="College Name" required>

    <div>
      <input type="checkbox" id="autoFillPhone" onclick="autoFillPhoneNumbers()">
      <label for="autoFillPhone">Auto-fill Phone Number to all team members</label>
    </div>
    <div>
      <input type="checkbox" id="autoFillCollege" onclick="autoFillCollegeName()">
      <label for="autoFillCollege">Auto-fill college name for all team members</label>
    </div>

    <div id="additionalTeamMembers">
      <!-- Additional team members will be populated here -->
    </div>
  </div>

  <label for="payment">Payment:</label>
  <input type="text" id="payment" placeholder="Payment Amount" required>

  <label for="email">Email:</label>
  <input type="email" id="email" placeholder="Email id" required>

  <button type="submit">Register</button>
  <button type="button" onclick="clearForm()">Clear Form</button>
</form>

<table id="dataTable" style="display:none;">
  <thead>
    <tr>
      <th>ID</th>
      <th>Event Name</th>
      <th>Item Name</th>
      <th>Participants</th>
      <th>Phone Numbers</th>
      <th>College</th>
      <th>Email</th>
      <th>Payment</th>
    </tr>
  </thead>
  <tbody></tbody>
</table>
<button id="deleteButton" onclick="deleteLastEntry()">Delete Last Entry</button>
<button id="exportButton" onclick="exportToExcel()">Export All to Excel</button>
<button class="exportTypeButton" onclick="exportToExcelByType('management')">Export Management to Excel</button>
<button class="exportTypeButton" onclick="exportToExcelByType('tech')">Export Tech to Excel</button>
<button class="exportTypeButton" onclick="exportToExcelByType('common')">Export Common to Excel</button>
<button id="printButton" onclick="printEntries()">Print Entries</button>
<button class="exportTypeButton" id="exportCSVButton" onclick="exportToCSVByEvent()">Export to CSV</button>
<button id="resetButton">Reset Page: Be Carefull!!!</button>


<script>
  let registrations = JSON.parse(localStorage.getItem('registrations')) || [];
  let startingPoint = parseInt(localStorage.getItem('startingPoint')) || 1;

  function saveToLocalStorage() {
    localStorage.setItem('registrations', JSON.stringify(registrations));
    localStorage.setItem('startingPoint', startingPoint);
  }

  function deleteLastEntry() {
    if (confirm("Are you sure you want to delete the last entry?")) {
      if (registrations.length > 0) {
        registrations.pop();
        saveToLocalStorage();
        updateTable();
      } else {
        alert("No entries to delete!");
      }
    }
  }

  function handleSubmit(event) {
    event.preventDefault();
    const eventType = document.getElementById('eventType').value;
    const eventItem = document.getElementById('eventItem').value;
    const participants = [];
    const phoneNumbers = [];
    const college = document.getElementById('college1').value;
    const payment = document.getElementById('payment').value;
    const email = document.getElementById('email').value;

    const teamSize = document.querySelectorAll('#additionalTeamMembers input').length / 3;
    for (let i = 1; i <= teamSize + 1; i++) {
      participants.push(document.getElementById(`teamMember${i}`).value);
      phoneNumbers.push(document.getElementById(`phone${i}`).value);
    }

    const entryID = `${eventType.charAt(0).toUpperCase()}-${eventItem.slice(0, 3).toUpperCase()}-${startingPoint++}`;

    const registration = {
      id: entryID,
      eventName: eventType,
      itemName: eventItem,
      participants: participants.map(name => name).join(','),
      phoneNumbers: phoneNumbers.map(phone => phone).join(','),
      college,
      email,
      payment,
    };

    registrations.push(registration);
    saveToLocalStorage();
    updateTable();
    clearForm();
    alert("Registration successful!");
}
function exportToExcel() {
      const worksheet = XLSX.utils.json_to_sheet(registrations);
      const workbook = XLSX.utils.book_new();
      XLSX.utils.book_append_sheet(workbook, worksheet, "Registrations");
      XLSX.writeFile(workbook, "Registrations.xlsx");
    }

    function exportToExcelByType(type) {
      const filteredData = registrations.filter(reg => reg.eventName === type);
      const worksheet = XLSX.utils.json_to_sheet(filteredData);
      const workbook = XLSX.utils.book_new();
      XLSX.utils.book_append_sheet(workbook, worksheet, `${type} Registrations`);
      XLSX.writeFile(workbook, `${type}_Registrations.xlsx`);
    }

    function exportToCSVByEvent() {
  // Prompt the user to select the event type
  const eventType = prompt("Enter event type to export (tech/management/common/all):").toLowerCase();

  if (!eventType) {
    alert("Event type is required to proceed.");
    return;
  }

  // Filter registrations based on the event type
  let filteredData = registrations;
  if (eventType !== "all") {
    filteredData = registrations.filter(reg => reg.eventName.toLowerCase() === eventType);
  }

  // Check if there's data to export
  if (filteredData.length === 0) {
    alert(`No registrations found for the selected event type: ${eventType}`);
    return;
  }

  // Convert the filtered data into CSV format
  let csvContent = "data:text/csv;charset=utf-8,";
  csvContent += "ID,Event Name,Item Name,Participants,Phone Numbers,College,Email,Payment\n"; // Header

  filteredData.forEach(entry => {
    const row = [
      entry.id,
      entry.eventName,
      entry.itemName,
      `"${entry.participants}"`, // Wrap in quotes for multi-line fields
      `"${entry.phoneNumbers}"`,
      entry.college,
      entry.email,
      entry.payment
    ].join(",");
    csvContent += row + "\n";
  });

  // Create a link to download the CSV file
  const encodedUri = encodeURI(csvContent);
  const link = document.createElement("a");
  link.setAttribute("href", encodedUri);
  link.setAttribute("download", `${eventType}_Registrations.csv`);
  document.body.appendChild(link); // Required for Firefox
  link.click();
  document.body.removeChild(link); // Clean up
}


  function printEntries() {
  const type = prompt("Enter type of event to print (tech/management/common/all):").toLowerCase();
  let filteredRegistrations = registrations;

  if (type !== 'all') {
    filteredRegistrations = registrations.filter(reg => reg.eventName === type);
  }

  if (filteredRegistrations.length === 0) {
    alert("No data available for the selected type!");
    return;
  }

  // Dynamically set the heading for the event type
  const eventTypeHeading = type === 'all' ? 'All Events' : `${type.charAt(0).toUpperCase() + type.slice(1)} Event`;

  let printContent = `
    <h3 style="text-align: center;">Euphoria 2k25</h3>
    <h4 style="text-align: center;">Tech and Management Fest</h4>
    <h5 style="text-align: center;">Offline Registration Portal</h5>
    <h6 style="text-align: center; margin-top: 10px; color: gray;">Event Type: ${eventTypeHeading}</h6>
    <table border="1" style="width: 100%; border-collapse: collapse; margin-top: 20px;">
      <thead>
        <tr>
          <th>No:</th>
          <th>ID</th>
          <th>Participants</th>
          <th>Phone Numbers</th>
        </tr>
      </thead>
      <tbody>
  `;

  filteredRegistrations.forEach((entry, index) => {
    printContent += `
      <tr>
        <td>${index + 1}</td> <!-- Incremental number starting from 1 -->
        <td>${entry.id}</td>
        <td><pre>${entry.participants}</pre></td>
        <td><pre>${entry.phoneNumbers}</pre></td>
      </tr>
    `;
  });

  printContent += `
      </tbody>
    </table>
  `;

  const newWindow = window.open();
  newWindow.document.write(printContent);
  newWindow.document.close();
  newWindow.print();
}
  function autoFillCollegeName() {
      const autoFill = document.getElementById('autoFillCollege').checked;
      const college1 = document.getElementById('college1').value;

      if (autoFill && college1) {
        const teamSize = document.querySelectorAll('#additionalTeamMembers input').length / 3;
        for (let i = 2; i <= teamSize + 1; i++) {
          document.getElementById(`college${i}`).value = college1;
        }
      }
    }
    const managementItems = [
    { name: 'no item selected', teamSize: 0 },
    { name: 'Excelsior Elite', teamSize: 4 },
    { name: 'Brand Blite', teamSize: 4 },
    { name: 'Eureka', teamSize: 2 }
  ];

  const techItems = [
    { name: 'no item selected', teamSize: 0 },
    { name: 'DecodeX', teamSize: 1 },
    { name: 'Bug Bounty', teamSize: 1 },
    { name: 'Ideate Airena', teamSize: 2 },
    { name: 'All Items', teamSize: 1 }
  ];

  const commonItems = [
    { name: 'no item selected', teamSize: 0 },
    { name: 'IPL Auction', teamSize: 4 },
    { name: 'Mystery Mavens', teamSize: 4 }
  ];

  function displayItems() {
    const eventType = document.getElementById('eventType').value;
    const eventItemDropdown = document.getElementById('eventItem');
    const eventItemsDiv = document.getElementById('eventItems');
    eventItemDropdown.innerHTML = '';
    eventItemsDiv.style.display = 'none';

    let items;
    if (eventType === 'management') items = managementItems;
    else if (eventType === 'tech') items = techItems;
    else if (eventType === 'common') items = commonItems;

    if (items) {
      eventItemsDiv.style.display = 'block';
      items.forEach(item => {
        const option = document.createElement('option');
        option.value = item.name;
        option.textContent = item.name;
        eventItemDropdown.appendChild(option);
      });
    }
  }

  function updateTeamInput() {
    const eventType = document.getElementById('eventType').value;
    const eventItem = document.getElementById('eventItem').value;
    const teamMembersDiv = document.getElementById('teamMembers');
    const additionalTeamMembersDiv = document.getElementById('additionalTeamMembers');
    additionalTeamMembersDiv.innerHTML = '';

    let teamSize = 1;
    const items = eventType === 'management' ? managementItems : eventType === 'tech' ? techItems : commonItems;
    const selectedItem = items.find(item => item.name === eventItem);
    teamSize = selectedItem ? selectedItem.teamSize : 1;

    teamMembersDiv.style.display = 'block';

    for (let i = 2; i <= teamSize; i++) {
      additionalTeamMembersDiv.innerHTML += `
        <label>Team Member ${i}:</label>
        <input type="text" id="teamMember${i}" placeholder="Team Member ${i} Name" required>
        <input type="text" id="phone${i}" placeholder="Phone Number" required>
        <input type="text" id="college${i}" placeholder="College Name" required>
      `;
    }
  }

  function autoFillPhoneNumbers() {
    const autoFill = document.getElementById('autoFillPhone').checked;
    const phone1 = document.getElementById('phone1').value;

    if (autoFill && phone1) {
      const teamSize = document.querySelectorAll('#additionalTeamMembers input').length / 3;
      for (let i = 2; i <= teamSize + 1; i++) {
        document.getElementById(`phone${i}`).value = phone1;
      }
    }
  }
  function updateTable() {
  const table = document.getElementById('dataTable');
  const tbody = table.querySelector('tbody');
  tbody.innerHTML = '';
  table.style.display = registrations.length > 0 ? 'table' : 'none';

  registrations.forEach(registration => {
    const row = document.createElement('tr');
    row.innerHTML = `
      <td>${registration.id}</td>
      <td>${registration.eventName}</td>
      <td>${registration.itemName}</td>
      <td>${registration.participants}</td>
      <td>${registration.phoneNumbers}</td>
      <td>${registration.college}</td>
      <td>${registration.email}</td>
      <td>${registration.payment}</td>
    `;
    tbody.appendChild(row);
  });
}


  function clearForm() {
    document.getElementById('registrationForm').reset();
    document.getElementById('eventItems').style.display = 'none';
    document.getElementById('teamMembers').style.display = 'none';
  }
  window.onload = function () {
    // Retrieve data from localStorage
    const storedRegistrations = JSON.parse(localStorage.getItem('registrations')) || [];
    const storedStartingPoint = localStorage.getItem('startingPoint');

    if (storedRegistrations.length > 0) {
        // Load registrations and update the table
        registrations = storedRegistrations;
        updateTable();

        // Set the starting point to the last entry's ID + 1
        const lastEntry = storedRegistrations[storedRegistrations.length - 1];
        const lastEntryId = parseInt(lastEntry.id.split('-').pop(), 10); // Extract numeric part of ID
        startingPoint = lastEntryId + 1;
    }  else {
        // Prompt the user for the starting point if no entries exist
        const startingInput = prompt("Enter starting position (e.g., 101, 201, 301):");
        if (startingInput && !isNaN(startingInput)) {
            startingPoint = parseInt(startingInput, 10);
        } else {
            alert("Invalid input. Starting point set to 1 by default.");
            startingPoint = 1;
        }
    }

    saveToLocalStorage(); // Save the updated starting point
};



window.onbeforeunload = function () {
  return "Are you sure you want to leave this page? Unsaved data will be lost. Please export to excel before leaving!!";
};
document.getElementById('resetButton').addEventListener('click', function () {
  if (confirm('Are you sure you want to reset the page? This will clear all data.')) {
    // Clear local storage
    localStorage.clear();
    // Reload the page
    location.reload();
  }
});

</script>
</body>
</html>
