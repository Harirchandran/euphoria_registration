<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Euphoria 2k25 Registration</title>
  
  <style>
  
/* General Body Styling */
body {
  font-family: Arial, sans-serif;
  margin: 0;
  padding: 0;
  background-color: #e8e5e5;
  color: #333;
}

/* Headings */
h1, h2, h3 {
  text-align: center;
  margin: 10px 0;
  color: #007BFF;
}

h1 {
  font-size: 2.5em;
  text-transform: uppercase;
  margin-bottom: 5px;
}

h2 {
  font-size: 1.5em;
  color: #555;
}

h3 {
  font-size: 1.2em;
  margin-top: 10px;
}

/* Form Styling */
form {
  max-width: 500px;
  margin: 20px auto;
  background: white;
  padding: 20px;
  border-radius: 8px;
  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
}

form label {
  font-weight: bold;
  margin-bottom: 5px;
  display: block;
}

form input, form select {
  width: calc(100% - 20px);
  padding: 10px;
  margin-bottom: 15px;
  border: 1px solid #ccc;
  border-radius: 5px;
  box-sizing: border-box;
}

form button {
  padding: 10px 15px;
  border: none;
  border-radius: 5px;
  cursor: pointer;
  font-size: 14px;
  margin-right: 10px;
  transition: background-color 0.3s ease, transform 0.2s ease;
}

form button:hover {
  transform: scale(1.05);
  opacity: 0.9;
}

form button[type="submit"] {
  background-color: #007BFF;
  color: #fff;
}

form button[type="reset"] {
  background-color: #6c757d;
  color: #fff;
}

/* Table Styling */
table {
  width: 90%;
  margin: 20px auto;
  border-collapse: collapse;
  background: white;
  border-radius: 8px;
  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
}

table th, table td {
  padding: 10px;
  text-align: left;
  border: 1px solid #ccc;
}

table th {
  background-color: #007BFF;
  color: white;
}

table tr:nth-child(even) {
  background-color: #f9f9f9;
}

/* Scroll Buttons */
.scroll-button {
  position: fixed;
  padding: 10px 20px;
  background-color: #4CAF50;
  color: white;
  border: none;
  border-radius: 5px;
  cursor: pointer;
  z-index: 1000;
  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
}

#scrollToBottom {
  bottom: 20px;
  right: 20px;
}

#scrollToTop {
  bottom: 70px;
  right: 20px;
}

/* Footer */
footer {
  background-color: #333;
  color: white;
  text-align: center;
  padding: 15px 10px;
  position: relative;
  width: 100%;
  font-size: 14px;
}

footer a {
  color: white;
  text-decoration: none;
}

footer a:hover {
  color: #4CAF50;
}

.footer-content {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 10px;
}

.insta-link {
  display: flex;
  align-items: center;
  gap: 10px;
  margin-top: 10px;
}

.insta-link img {
  width: 24px;
  height: 24px;
}

.insta-link a {
  color: #E1306C;
  font-weight: bold;
  text-decoration: none;
  font-size: 14px;
}

.insta-link a:hover {
  color: #FF4081;
}
/* General Footer Button Styling */
footer button {
  padding: 10px 20px;
  margin: 5px;
  background-color: #007BFF;
  color: white;
  font-size: 14px;
  font-weight: bold;
  border: none;
  border-radius: 5px;
  cursor: pointer;
  transition: background-color 0.3s ease, transform 0.2s ease;
  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
}

footer button:hover {
  transform: scale(1.05);
}

footer button:active {
  transform: scale(1);
}

/* Specific Styling for Reset Button */
footer .reset-button {
  background-color: #ff0000; /* Bootstrap red */
}

footer .reset-button:hover {
  background-color: #f17481; /* Darker red on hover */
}

footer .reset-button:active {
  background-color: #851a24; /* Even darker red when clicked */
}

/* Disabled Button Styling */
footer button:disabled {
  background-color: #6c757d;
  cursor: not-allowed;
}

/* Responsive Footer Buttons */
@media (max-width: 768px) {
  footer button {
    width: calc(100% - 20px); /* Full-width button */
    margin: 10px auto;       /* Center margin */
    font-size: 13px;         /* Adjust text size */
  }
}


/* Responsive Design */
@media (max-width: 768px) {
  form {
    padding: 15px;
  }

  form button {
    width: 100%;
    margin-bottom: 10px;
  }

  table {
    font-size: 14px;
  }

  th, td {
    padding: 8px;
  }
}

@media (max-width: 480px) {
  form {
    padding: 10px;
  }

  input, select {
    font-size: 12px;
  }

  button {
    padding: 8px;
    font-size: 12px;
    border-radius: 4px;
  }

  table {
    font-size: 12px;
  }

  footer {
    font-size: 12px;
  }

  .insta-link img {
    width: 20px;
    height: 20px;
  }

  .insta-link a {
    font-size: 12px;
  }
}
/* General Styles for Buttons */
.scroll-button {
  position: fixed;
  bottom: 20px; /* Distance from the bottom */
  right: 20px; /* Distance from the right edge */
  background-color: #28a745; /* Green color */
  color: white;
  border: none;
  border-radius: 5px; /* Slightly rounded corners */
  padding: 10px 20px; /* Padding for better button shape */
  font-size: 16px; /* Text size */
  display: none; /* Initially hidden */
  z-index: 1000; /* Ensure buttons are on top */
  cursor: pointer;
  text-align: center;
  transition: background-color 0.3s ease;
}

/* Hover Effect for Buttons */
.scroll-button:hover {
  background-color: #218838; /* Darker shade for hover (green) */
}

/* For large screens (laptops and desktops) */
@media (min-width: 768px) {
  .scroll-button {
    bottom: 20px;
    right: 20px;
    padding: 10px 20px;
    font-size: 16px;
    width: auto; /* Remove fixed width for auto sizing */
  }


}

/* For mobile screens (less than 768px) */
@media (max-width: 768px) {
  .scroll-button {
    bottom: 10px; /* Slightly closer to the bottom for better touch access */
    right: 10px; /* Adjust position for mobile */
    padding: 8px 16px; /* Slightly smaller padding for mobile */
    font-size: 14px; /* Smaller font size for mobile */
    display: block; /* Ensure buttons are always visible */
  }

  .scroll-button.up,
  .scroll-button.down {
    width: 100px; /* Fixed width for both buttons */
  }
}
/* General Styles for Buttons */
.scroll-button {
  position: fixed;
  bottom: 20px; /* Distance from the bottom */
  right: 20px; /* Distance from the right edge */
  background-color: #28a745; /* Default green color for both buttons */
  color: rgb(0, 0, 0);
  border: none;
  border-radius: 50px; /* Slightly rounded corners */
  padding: 10px 20px; /* Padding for better button shape */
  font-size: 16px; /* Text size */
  display: none; /* Initially hidden */
  z-index: 1000; /* Ensure buttons are on top */
  cursor: pointer;
  text-align: center;
  transition: background-color 0.3s ease;
}

/* Hover Effect for Buttons */
.scroll-button:hover {
  background-color: #218838; /* Darker shade for hover (green) */
}

/* Styling specifically for the "Up" button */
.scroll-button.up {
  background-color: #07f7ff; /* Blue color for "Up" button */
  right: 20px; /* Position to the right of the screen */
  bottom: 20px; /* Distance from the bottom */
}

/* Styling specifically for the "Down" button */
.scroll-button.down {
  background-color: #07f7ff; /* Yellow color for "Down" button */
  right: 20px; /* Position to the right of the screen */
  bottom: 80px; /* Slightly above the "Up" button */
}

/* For large screens (laptops and desktops) */
@media (min-width: 768px) {
  .scroll-button {
    padding: 10px 20px;
    font-size: 16px;
    width: auto; /* Remove fixed width for auto sizing */
  }

  .scroll-button.up {
    background-color:#07f7ff; /* Blue for "Up" */
  }

  .scroll-button.down {
    background-color: #07f7ff; /* Yellow for "Down" */
  }
}

/* For mobile screens (less than 768px) */
@media (max-width: 768px) {
  .scroll-button {
    bottom: 10px; /* Slightly closer to the bottom for better touch access */
    right: 10px; /* Adjust position for mobile */
    padding: 8px 16px; /* Slightly smaller padding for mobile */
    font-size: 14px; /* Smaller font size for mobile */
    display: block; /* Ensure buttons are always visible */
  }

  .scroll-button.up {
    bottom: 10px; /* Bottom position for "Up" button */
    background-color:#07f7ff; /* Blue for "Up" */
  }

  .scroll-button.down {
    bottom: 60px; /* Position it slightly above "Up" button */
    background-color:#07f7ff; /* Yellow for "Down" */
  }
}



  </style>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.3/xlsx.full.min.js"></script>
</head>
<body>

<h1>Euphoria 2K25</h1>
<h2>Tech and Management Fest</h2>
<h2>Marthoma Institute of Information Technology</h2>
<h3>Offline Registration Portal 1.0</h3>


<!-- Registration Form -->
<form id="registrationForm" onsubmit="handleSubmit(event)">
  <label for="eventType">Choose Event:</label>
  <select id="eventType" required onchange="displayItems()">
    <option value="">Select Event</option>
    <option value="management">Management</option>
    <option value="tech">Tech</option>
    <option value="common">Common</option>
  </select>

  <div id="eventItems" style="display:none;">
    <label for="eventItem">Select Item:</label>
    <select id="eventItem" required onchange="updateTeamInput()">
      <!-- Dynamically populated based on selected event -->
    </select>
  </div>

  <div id="teamMembers" style="display:none;">
    <h3>Team Members Details:</h3>
    <label>Team Member 1 :</label>
    <input type="text" id="teamMember1" placeholder="Team Member 1 Name" required>
    <input type="text" id="phone1" placeholder="Phone Number" required>
    <input type="text" id="college1" placeholder="College Name" required>

    <div>
      <input type="checkbox" id="autoFillPhone" onclick="autoFillPhoneNumbers()">
      <label for="autoFillPhone">Auto-fill Phone Number to all team members</label>
    </div>
    <div>
      <input type="checkbox" id="autoFillCollege" onclick="autoFillCollegeName()">
      <label for="autoFillCollege">Auto-fill college name for all team members</label>
    </div>

    <div id="additionalTeamMembers">
      <!-- Additional team members will be populated here -->
    </div>
  </div>

  <label for="payment">Payment:</label>
  <input type="text" id="payment" placeholder="Payment Amount" required>

  <label for="email">Email:</label>
  <input type="email" id="email" placeholder="Email id" required>

  <button type="submit">Register</button>
  <button type="button" onclick="clearForm()">Clear Form</button>
</form>

<!-- Scroll Buttons with Text for "Up" and "Down" -->
<button id="scrollToBottom" class="scroll-button down">Down</button> <!-- "Down" button -->
<button id="scrollToTop" class="scroll-button up">Up</button> <!-- "Up" button -->




<table id="dataTable" style="display:none;">
  <thead>
    <tr>
      <th>ID</th>
      <th>Event Name</th>
      <th>Item Name</th>
      <th>Participants</th>
      <th>Phone Numbers</th>
      <th>College</th>
      <th>Email</th>
      <th>Payment</th>
    </tr>
  </thead>
  <tbody></tbody>
</table>



<!-- Footer -->
<footer>
  
  <div class="footer-buttons">
  <button id="deleteButton" onclick="deleteLastEntry()">Delete Last Entry( page will reload to take effect) </button>
<button id="exportButton" onclick="exportToExcel()">Export Data to Excel</button>

<button id="printButton" onclick="printEntries()">Print Data by Type</button>

<button class="reset-button"  id="resetButton">Reset All Data</button>

<div class="footer-content">
  
    <p>Website developed by Hari R Chandran, student of MCA batch 2024-2026, MIIT, Ayoor.</p>
    
    <div class="insta-link">
      <img src="https://upload.wikimedia.org/wikipedia/commons/a/a5/Instagram_icon.png" alt="Instagram Logo">
      <a href="https://www.instagram.com/hari_r_c?igsh=MTNsazJzdXJodW5uZQ==" target="_blank">Connect on Instagram</a>
    </div>
  </div>
</footer>

<script>
// Scroll to Top Button
const scrollToTopButton = document.getElementById('scrollToTop');
const scrollToBottomButton = document.getElementById('scrollToBottom');

// Function to check if buttons should be shown or hidden
function toggleScrollButtons() {
  const scrollPosition = window.scrollY;
  const pageHeight = document.documentElement.scrollHeight - window.innerHeight;

  // Show the 'scroll to top' button if scrolled down
  if (scrollPosition > 0) {
    scrollToTopButton.style.display = 'block';
  } else {
    scrollToTopButton.style.display = 'none';
  }

  // Show the 'scroll to bottom' button if not at the bottom
  if (scrollPosition < pageHeight) {
    scrollToBottomButton.style.display = 'block';
  } else {
    scrollToBottomButton.style.display = 'none';
  }
}

// Event listeners for scroll buttons
scrollToTopButton.addEventListener('click', () => {
  window.scrollTo({ top: 0, behavior: 'smooth' });
});

scrollToBottomButton.addEventListener('click', () => {
  window.scrollTo({ top: document.body.scrollHeight, behavior: 'smooth' });
});

// Listen to scroll events to toggle the buttons
window.addEventListener('scroll', toggleScrollButtons);

// Initial check on page load
toggleScrollButtons();





  
  let registrations = JSON.parse(localStorage.getItem('registrations')) || [];
  let startingPoint = parseInt(localStorage.getItem('startingPoint')) || 1;

  function saveToLocalStorage() {
    localStorage.setItem('registrations', JSON.stringify(registrations));
    localStorage.setItem('startingPoint', startingPoint);
  }
  function autoFillCollegeName() {
      const autoFill = document.getElementById('autoFillCollege').checked;
      const college1 = document.getElementById('college1').value;

      if (autoFill && college1) {
        const teamSize = document.querySelectorAll('#additionalTeamMembers input').length / 3;
        for (let i = 2; i <= teamSize + 1; i++) {
          document.getElementById(`college${i}`).value = college1;
        }
      }
    }
    const managementItems = [
    { name: 'no item selected', teamSize: 0 },
    { name: 'Excelsior Elite', teamSize: 4 },
    { name: 'Brand Blite', teamSize: 4 },
    { name: 'Eureka', teamSize: 2 }
  ];

  const techItems = [
    { name: 'no item selected', teamSize: 0 },
    { name: 'DecodeX', teamSize: 1 },
    { name: 'Bug Bounty', teamSize: 1 },
    { name: 'Ideate Airena', teamSize: 2 },
    { name: 'All Items', teamSize: 2 }
  ];

  const commonItems = [
    { name: 'no item selected', teamSize: 0 },
    { name: 'IPL Auction', teamSize: 4 },
    { name: 'Mystery Mavens', teamSize: 4 }
  ];

  function displayItems() {
    const eventType = document.getElementById('eventType').value;
    const eventItemDropdown = document.getElementById('eventItem');
    const eventItemsDiv = document.getElementById('eventItems');
    eventItemDropdown.innerHTML = '';
    eventItemsDiv.style.display = 'none';

    let items;
    if (eventType === 'management') items = managementItems;
    else if (eventType === 'tech') items = techItems;
    else if (eventType === 'common') items = commonItems;

    if (items) {
      eventItemsDiv.style.display = 'block';
      items.forEach(item => {
        const option = document.createElement('option');
        option.value = item.name;
        option.textContent = item.name;
        eventItemDropdown.appendChild(option);
      });
    }
  }

  function reloadPage() {
  location.reload(); // Reloads the current page
}


  function deleteLastEntry() {
    if (confirm("Are you sure you want to delete the last entry?")) {
      if (registrations.length > 0) {
        registrations.pop();
        saveToLocalStorage();
        
        updateTable();
        reloadPage()
        alert("Last entry deleted successfully!!")
        
      } else {
        alert("No entries to delete!");
      }
    }
  }

  function handleSubmit(event) {
    event.preventDefault();
    const eventType = document.getElementById('eventType').value;
    const eventItem = document.getElementById('eventItem').value;
    const participants = [];
    const phoneNumbers = [];
    const college = document.getElementById('college1').value;
    const payment = document.getElementById('payment').value;
    const email = document.getElementById('email').value;

    const teamSize = document.querySelectorAll('#additionalTeamMembers input').length / 3;
    for (let i = 1; i <= teamSize + 1; i++) {
      participants.push(document.getElementById(`teamMember${i}`).value);
      phoneNumbers.push(document.getElementById(`phone${i}`).value);
    }

    const entryID = `${eventType.charAt(0).toUpperCase()}-${eventItem.slice(0, 3).toUpperCase()}-${startingPoint++}`;

    const registration = {
      id: entryID,
      eventName: eventType,
      itemName: eventItem,
      participants: participants.map(name => name).join(','),
      phoneNumbers: phoneNumbers.map(phone => phone).join(','),
      college,
      email,
      payment,
    };

    registrations.push(registration);
    
    saveToLocalStorage();
    updateTable();
    clearForm();
    alert("Registration successful!");
    window.scrollTo({ top: document.body.scrollHeight, behavior: 'smooth' });

}


function exportToExcel() {
  if(
    confirm("The full data will be downloaded as excel format. Do you wish to proceed?")
  ){
 
      const worksheet = XLSX.utils.json_to_sheet(registrations);
      const workbook = XLSX.utils.book_new();
      XLSX.utils.book_append_sheet(workbook, worksheet, "Registrations");
      XLSX.writeFile(workbook, "Registrations.xlsx");
    }
  }




function printEntries() {
  const type = prompt("Enter type of event to print (tech/management/common/all):").toLowerCase();
  let filteredRegistrations = registrations;

  if (type !== 'all') {
    filteredRegistrations = registrations.filter(reg => reg.eventName === type);
  }

  if (filteredRegistrations.length === 0) {
    alert("No data available for the selected type!");
    return;
  }

  // Dynamically set the heading for the event type
  const eventTypeHeading = type === 'all' ? 'All Events' : `${type.charAt(0).toUpperCase() + type.slice(1)} Event`;

  // Group by characters between the hyphens in the ID
  const groupedRegistrations = filteredRegistrations.reduce((acc, reg) => {
    const middlePart = reg.id.split('-')[1]; // Extract the part between the hyphens
    acc[middlePart] = acc[middlePart] || [];
    acc[middlePart].push(reg);
    return acc;
  }, {});

  let printContent = `
    <h3 style="text-align: center;">Euphoria 2k25</h3>
    <h4 style="text-align: center;">Tech and Management Fest</h4>
    <h5 style="text-align: center;">Offline Registration Portal</h5>
    <h6 style="text-align: center; margin-top: 10px; color: gray;">Event Type: ${eventTypeHeading}</h6>
  `;

  Object.keys(groupedRegistrations).forEach(groupKey => {
    printContent += `
      <h5 style="text-align: left; margin-top: 20px; color: black;">Item: ${groupKey.toUpperCase()}</h5>
      <table border="1" style="width: 100%; border-collapse: collapse; margin-top: 10px;">
        <thead>
          <tr>
            <th>No:</th>
            <th>ID</th>
            <th>Participants</th>
            <th>Phone Numbers</th>
          </tr>
        </thead>
        <tbody>
    `;

    groupedRegistrations[groupKey].forEach((entry, index) => {
      printContent += `
        <tr>
          <td>${index + 1}</td>
          <td>${entry.id}</td>
          <td><pre>${entry.participants}</pre></td>
          <td><pre>${entry.phoneNumbers}</pre></td>
        </tr>
      `;
    });

    printContent += `
        </tbody>
      </table>
    `;
  });

  const newWindow = window.open();
  newWindow.document.write(printContent);
  newWindow.document.close();
  newWindow.print();
}


  

  function updateTeamInput() {
    const eventType = document.getElementById('eventType').value;
    const eventItem = document.getElementById('eventItem').value;
    const teamMembersDiv = document.getElementById('teamMembers');
    const additionalTeamMembersDiv = document.getElementById('additionalTeamMembers');
    additionalTeamMembersDiv.innerHTML = '';

    let teamSize = 1;
    const items = eventType === 'management' ? managementItems : eventType === 'tech' ? techItems : commonItems;
    const selectedItem = items.find(item => item.name === eventItem);
    teamSize = selectedItem ? selectedItem.teamSize : 1;

    teamMembersDiv.style.display = 'block';

    for (let i = 2; i <= teamSize; i++) {
      additionalTeamMembersDiv.innerHTML += `
        <label>Team Member ${i}:</label>
        <input type="text" id="teamMember${i}" placeholder="Team Member ${i} Name" required>
        <input type="text" id="phone${i}" placeholder="Phone Number" required>
        <input type="text" id="college${i}" placeholder="College Name" required>
      `;
    }
  }

  function autoFillPhoneNumbers() {
    const autoFill = document.getElementById('autoFillPhone').checked;
    const phone1 = document.getElementById('phone1').value;

    if (autoFill && phone1) {
      const teamSize = document.querySelectorAll('#additionalTeamMembers input').length / 3;
      for (let i = 2; i <= teamSize + 1; i++) {
        document.getElementById(`phone${i}`).value = phone1;
      }
    }
  }
  


  function clearForm() {
    document.getElementById('registrationForm').reset();
    document.getElementById('eventItems').style.display = 'none';
    document.getElementById('teamMembers').style.display = 'none';
  }
  window.onload = function () {
    // Retrieve data from localStorage
    const storedRegistrations = JSON.parse(localStorage.getItem('registrations')) || [];
    const storedStartingPoint = localStorage.getItem('startingPoint');

    if (storedRegistrations.length > 0) {
        // Load registrations and update the table
        registrations = storedRegistrations;
        

        // Set the starting point to the last entry's ID + 1
        const lastEntry = storedRegistrations[storedRegistrations.length - 1];
        const lastEntryId = parseInt(lastEntry.id.split('-').pop(), 10); // Extract numeric part of ID
        startingPoint = lastEntryId + 1;
    }  else {
        // Prompt the user for the starting point if no entries exist
        const startingInput = prompt("Enter starting number for registration eg:001,101,201,etc:");
        if (startingInput && !isNaN(startingInput)) {
            startingPoint = parseInt(startingInput, 10);
        } 
        else if (storedStartingPoint) {
        // Use saved starting point if no entries exist
        startingPoint = parseInt(storedStartingPoint, 10);
        }else {
            alert("Invalid input. Starting point set to 1 by default.");
            startingPoint = 1;
        }
    }
    updateTable();
    saveToLocalStorage();
    window.scrollTo({ top: 0, behavior: 'smooth' }); // Save the updated starting point
};
function updateTable() {
  const table = document.getElementById('dataTable');
  const tbody = table.querySelector('tbody');
  tbody.innerHTML = '';
  table.style.display = registrations.length > 0 ? 'table' : 'none';

  registrations.forEach(registration => {
    const row = document.createElement('tr');
    row.innerHTML = `
      <td>${registration.id}</td>
      <td>${registration.eventName}</td>
      <td>${registration.itemName}</td>
      <td>${registration.participants}</td>
      <td>${registration.phoneNumbers}</td>
      <td>${registration.college}</td>
      <td>${registration.email}</td>
      <td>${registration.payment}</td>
    `;
    tbody.appendChild(row);
  });
}



window.onbeforeunload = function () {
  return "Are you sure you want to leave this page? Unsaved data will be lost. Please export to excel before leaving!!";
};
document.getElementById('resetButton').addEventListener('click', function () {
  if (confirm('Are you sure you want to reset the page? This will clear all data.')) {
    // Clear local storage
    localStorage.clear();
    // Reload the page
    location.reload();
  }
});

</script>
</body>
</html>
